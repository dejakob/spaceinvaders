<polymer-element name="singlegame-view" attributes="height width left">
    <template>
        <link rel="stylesheet" href="/components/singlegame.css" />
        <style>
            #wrapper {
                width: ((width))px;
                left: ((left))px;
            }
        </style>

        <div id="wrapper">
            <template if="((qrcode))">
                <div class="content">
                    <qr-code value="((qrcode))"></qr-code>
                </div>
            </template>

            <template if="((!qrcode))">
                <canvas class="content">

                </canvas>
                <span class="score">((score))</span>
                <div id="spaceship" style="((showGame ? 'display: block;' : 'display: none;')) left: ((spaceship.left))px; width: ((spaceship.width))px; bottom: ((spaceship.bottom))px; height: ((spaceship.height))px;"></div>
            </template>
        </div>

    </template>
    <script>
        //IMPORTANT: name with -
        require([
            'lib/jquery.js',
            'screen/spaceview.js',
            'components/gamesocket.js'
        ], function() {

            Polymer('singlegame-view', {
                qrcode: null,
                left: 0,
                stepX: 20,
                score: 100,
                ready: function() {
                    var self = this;
                    var callbacks = {};
                    callbacks['initView'] = function() {
                        console.log('init view', self.height, self.width);

                        self.showGame = true;
                        var spaceshipWidth = self.width / 10;
                        self.spaceship = {
                            left: (self.width - spaceshipWidth) / 2,
                            width: spaceshipWidth,
                            bottom: 15,
                            height: 1.5 * spaceshipWidth
                        };

                        self.stepX = self.width / 50;

                    };
                    callbacks['onLeft'] = function() {
                        if (typeof self.spaceship !== 'undefined') {
                            if (self.spaceship.left > 0) {
                                self.spaceship.left -= 20;
                            }
                        }
                    };
                    callbacks['onRight'] = function() {
                        if (typeof self.spaceship !== 'undefined') {
                            if (self.spaceship.left < (self.width - self.spaceship.width) ) {
                                self.spaceship.left += 20;
                            }
                        }
                    };

                    GameSocket.init(this, callbacks);
                },
                heightChanged: function() {

                },
                widthChanged: function() {

                }
            });
        });

    </script>
</polymer-element>